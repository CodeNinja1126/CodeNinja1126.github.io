I"L†<h1 id="pandas">Pandas</h1>

<ul>
  <li>êµ¬ì¡°í™”ëœ ë°ì´í„°ì˜ ì²˜ë¦¬ë¥¼ ì§€ì›í•˜ëŠ” Python ë¼ì´ë¸ŒëŸ¬ë¦¬</li>
  <li>panel data â†’ pandas</li>
  <li>ê³ ì„±ëŠ¥ array ê³„ì‚° ë¼ì´ë¸ŒëŸ¬ë¦¬ì¸ numpyì™€ í†µí•©í•˜ì—¬,
ê°•ë ¥í•œ â€˜ìŠ¤í”„ë ˆë“œì‹œíŠ¸â€™ì²˜ë¦¬ ê¸°ëŠ¥ì„ ì œê³µ</li>
  <li>ì¸ë±ì‹±, ì—°ì‚°ìš© í•¨ìˆ˜, ì „ì²˜ë¦¬ í•¨ìˆ˜ ë“±ì„ ì œê³µí•¨</li>
  <li>ë°ì´í„° ì²˜ë¦¬ ë° í†µê³„ ë¶„ì„ì„ ìœ„í•´ ì‚¬ìš©</li>
</ul>

<p><img src="/images/2021-01-28/22/1.png" alt="1.png" /></p>

<h2 id="ë°ì´í„°-ë¶ˆëŸ¬ì˜¤ê¸°">ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data_url</span> <span class="o">=</span> <span class="s">'[ë°ì´í„° url]'</span>
<span class="n">df_data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data_url</span><span class="p">,</span> <span class="n">sep</span><span class="s">'\s+'</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="bp">None</span><span class="p">)</span>
<span class="c1"># csv íƒ€ì… ë°ì´í„° ë¡œë“œ, seperateëŠ” ë¹ˆ ê³µê°„ìœ¼ë¡œ ì§€ì •í•¨
</span>
<span class="n">df_data</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
<span class="c1"># ì²« 5ê°œì˜ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜´
</span></code></pre></div></div>

<p>ë°ì´í„°ë“¤ì€ numpyì˜ arrayí˜•íƒœë¡œ ì´ë£¨ì–´ì ¸ ìˆìŒ. ì´ìƒì ì¸ ê²½ìš°ì—ëŠ” csv í˜•íƒœë¡œ ë°ì´í„°ë¥¼ ë°›ì•„ì˜¬ ìˆ˜ë„ ìˆì§€ë§Œ ëŒ€ë¶€ë¶„ì˜ ê²½ìš°ì—ëŠ” ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ìë£Œë¥¼ ì¶”ì¶œí•´ì™€ ì²˜ë¦¬í•˜ê¸° ì‰¬ìš´ í˜•íƒœë¡œ ë°”ê¾¸ì–´ì£¼ì–´ì•¼ í•œë‹¤.</p>

<h2 id="series">Series</h2>

<p>DataFrame ì¤‘ í•˜ë‚˜ì˜ Columnì— í•´ë‹¹í•˜ëŠ” object</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="n">list_data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
<span class="n">example_obj</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">list_data</span><span class="p">)</span>
<span class="n">example_obj</span>
<span class="s">'''
0    1
1    2
2    3
3    4
4    5
dtype: int64
'''</span>
<span class="n">index_name</span> <span class="o">=</span> <span class="p">[</span><span class="s">'a'</span><span class="p">,</span><span class="s">'b'</span><span class="p">,</span><span class="s">'c'</span><span class="p">,</span><span class="s">'d'</span><span class="p">,</span><span class="s">'e'</span><span class="p">]</span>
<span class="n">example_obj</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">list_data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index_name</span><span class="p">)</span>
<span class="n">example_obj</span>
<span class="s">'''
a    1
b    2
c    3
d    4
e    5
dtype: int64
'''</span>
<span class="n">dict_data</span> <span class="o">=</span> <span class="p">{</span><span class="s">'a'</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s">'b'</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s">'c'</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="s">'d'</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="s">'e'</span><span class="p">:</span><span class="mi">5</span><span class="p">}</span>
<span class="n">example_obj</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="n">dict_data</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">'exmaple_obj'</span><span class="p">)</span>
<span class="n">example_obj</span>
<span class="s">'''
a    1.0
b    2.0
c    3.0
d    4.0
e    5.0
Name: exmaple_obj, dtype: float64
'''</span>
<span class="n">example_obj</span><span class="p">[</span><span class="s">'a'</span><span class="p">]</span>
<span class="c1"># 1.0
</span>
<span class="n">example_obj</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="c1"># 2.0
</span>
<span class="n">example2</span> <span class="o">=</span> <span class="n">example_obj</span><span class="p">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">example2</span>
<span class="s">'''
a    1
b    2
c    3
d    4
e    5
Name: exmaple_obj, dtype: int64
'''</span>
<span class="n">example_obj</span><span class="p">.</span><span class="n">values</span>
<span class="c1"># array([1., 1., 3., 4., 5.])
</span>
<span class="n">example_obj</span><span class="p">.</span><span class="n">index</span>
<span class="c1"># Index(['a', 'b', 'c', 'd', 'e'], dtype='object')
</span>
<span class="n">dict_data_1</span> <span class="o">=</span> <span class="p">{</span><span class="s">'a'</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s">'b'</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s">'c'</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="s">'d'</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="s">'e'</span><span class="p">:</span><span class="mi">5</span><span class="p">}</span>
<span class="n">indexes</span> <span class="o">=</span> <span class="p">[</span><span class="s">'a'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">,</span> <span class="s">'c'</span><span class="p">,</span> <span class="s">'d'</span><span class="p">,</span> <span class="s">'e'</span><span class="p">,</span> <span class="s">'f'</span><span class="p">,</span> <span class="s">'g'</span><span class="p">,</span> <span class="s">'h'</span><span class="p">]</span>
<span class="n">series_obj_1</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="n">dict_data_1</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">indexes</span><span class="p">)</span>
<span class="n">series_obj_1</span>
<span class="s">'''
a    1.0
b    2.0
c    3.0
d    4.0
e    5.0
f    NaN
g    NaN
h    NaN
dtype: float64
'''</span>
<span class="c1"># ê¸°ë³¸ì ìœ¼ë¡œ dataframeê³¼ seriesëŠ” ì¸ë±ìŠ¤ê°€ ê¸°ì¤€ì´ ëœë‹¤.
# ë”°ë¼ì„œ ìœ„ì™€ ê°™ì€ ê²½ìš°ëŠ” ê°’ì´ ì—†ëŠ” ì¸ë±ìŠ¤ì— NaNê°’ì´ ë“¤ì–´ ê°”ë‹¤.
</span>
<span class="n">dict_data_1</span> <span class="o">=</span> <span class="p">{</span><span class="s">'a'</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s">'b'</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="s">'c'</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="s">'d'</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="s">'e'</span><span class="p">:</span><span class="mi">5</span><span class="p">}</span>
<span class="n">indexes</span> <span class="o">=</span> <span class="p">[</span><span class="s">'a'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">,</span> <span class="s">'c'</span><span class="p">,</span> <span class="s">'d'</span><span class="p">]</span>
<span class="n">series_obj_1</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="n">dict_data_1</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">indexes</span><span class="p">)</span>
<span class="n">series_obj_1</span>
<span class="s">'''
a    1
b    2
c    3
d    4
dtype: int64
'''</span>
</code></pre></div></div>

<h2 id="dataframe">DataFrame</h2>

<p>data table ì „ì²´ë¥¼ í¬í•¨í•˜ëŠ” objectì´ë‹¤. ê°’ì— ì ‘ê·¼í•˜ë ¤ë©´ indexì™€ column ëª¨ë‘ ì•Œì•„ì•¼ í•œë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dict_1</span> <span class="o">=</span> <span class="p">{</span><span class="s">'first_name'</span><span class="p">:</span> <span class="p">[</span><span class="s">'hyun'</span><span class="p">,</span> <span class="s">'ga'</span><span class="p">,</span> <span class="s">'woo'</span><span class="p">],</span>
        <span class="s">'last_name'</span><span class="p">:</span> <span class="p">[</span><span class="s">'han'</span><span class="p">,</span> <span class="s">'kim'</span><span class="p">,</span> <span class="s">'han'</span><span class="p">],</span>
        <span class="s">'age'</span><span class="p">:</span> <span class="p">[</span><span class="mi">28</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">24</span><span class="p">]}</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dict_1</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">'first_name'</span><span class="p">,</span> <span class="s">'last_name'</span><span class="p">,</span> <span class="s">'age'</span><span class="p">])</span>
<span class="s">'''
  first_name	last_name	 age
0	hyun	      han	       28
1	ga	        kim	       30
2	woo	        han	       24
'''</span>
</code></pre></div></div>

<p>ì´ë ‡ê²Œ dict íƒ€ì…ìœ¼ë¡œ DataFrameì„ ì„ ì–¸í•´ ì¤„ ìˆ˜ë„ ìˆì§€ë§Œ ì¼ë°˜ì ìœ¼ë¡œëŠ” csv í˜•íƒœë¡œ íŒŒì¼ì„ ê°€ì ¸ì˜¤ê¸° ë•Œë¬¸ì— ì´ë ‡ê²Œ ì‚¬ìš©í•  ì¼ì€ ê±°ì˜ ì—†ë‹¤.</p>

<ul class="task-list">
  <li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" disabled="disabled" />ë°ì´í„° í”„ë ˆì„ í•¨ìˆ˜ë“¤ì€ ë‚´ë¶€ì˜ ê°’ì„ ë³€í™”ì‹œí‚¤ì§„ ì•ŠëŠ”ë‹¤.
<code class="language-plaintext highlighter-rouge">inplace=true</code>ë¥¼ ë„˜ê¸¸ìˆ˜ ìˆëŠ” í•¨ìˆ˜ëŠ” ë‚´ë¶€ì˜ ê°’ì´ ë³€í™”ëœë‹¤.
ì¼ë°˜ì ìœ¼ë¡œ ê°’ì€ ìœ ì§€ì‹œí‚¤ëŠ”ê²Œ ë§ë‹¤.</li>
</ul>

<h3 id="columns">columns</h3>

<p>columnsëŠ” ë‚´ê°€ ë³´ê³  ì‹¶ì€ columns ê°’ë§Œ í¬í•¨í•´ DataFrameì„ ì§¤ ìˆ˜ ìˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">'first_name'</span><span class="p">,</span> <span class="s">'last_name'</span><span class="p">])</span>
<span class="s">'''
  first_name	last_name
0	hyun	      han
1	ga	        kim
2	woo	        han
'''</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">'first_name'</span><span class="p">,</span> <span class="s">'last_name'</span><span class="p">,</span> <span class="s">'sex'</span><span class="p">])</span>
<span class="s">'''
  first_name	last_name	sex
0	hyun han	NaN
1	ga	kim	NaN
2	woo	han	NaN
'''</span>

<span class="n">df</span><span class="p">[</span><span class="s">'first_name'</span><span class="p">]</span>
<span class="s">'''
0    hyun
1      ga
2     woo
Name: first_name, dtype: object
'''</span>
<span class="c1"># Seriesì˜ í˜•íƒœë¡œ ë°˜í™˜
</span>
<span class="n">df</span><span class="p">[</span><span class="s">'old'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">age</span> <span class="o">&gt;</span> <span class="mi">25</span>
<span class="s">'''
first_name	last_name	age	old
0	hyun	han	28	True
1	ga	kim	30	True
2	woo	han	24	False
'''</span>

<span class="k">del</span> <span class="n">df</span><span class="p">[</span><span class="s">'old'</span><span class="p">]</span>
<span class="s">'''
first_name	last_name	age
0	hyun	han	28
1	ga	kim	30
2	woo	han	24
'''</span>
<span class="c1"># ì•„ì˜ˆ ë©”ëª¨ë¦¬ ìƒì—ì„œ ì œê±°
</span>
<span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="s">'''
first_name     ga
last_name     kim
age            30
Name: 1, dtype: object
'''</span>

<span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="s">'first_name'</span><span class="p">,</span> <span class="s">'last_name'</span><span class="p">]]</span>
<span class="s">'''
first_name	last_name
1	ga	kim
2	woo	han
'''</span>

<span class="n">df</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="s">'''
first_name     ga
last_name     kim
age            30
Name: 1, dtype: object
'''</span>
<span class="s">'''
ì„ ì–¸í–ˆë˜ dfì˜ ê²½ìš°ì—ëŠ” ì‹¤ì œë¡œ ìë£Œì— ì €ì¥ëœ ìˆœì„œì™€ ì¸ë±ìŠ¤ì˜ ë²ˆí˜¸ê°€ ì¼ì¹˜í•œë‹¤. 
ê·¸ë˜ì„œ df.loc[1]ê³¼ ê°™ì€ ê²°ê³¼ê°€ ë‚˜ì˜¤ê²Œ ëœ ê²ƒì´ë‹¤. 
í•˜ì§€ë§Œ ìë£Œì˜ ìˆœì„œì™€ ì¸ë±ìŠ¤ì˜ ë²ˆí˜¸ê°€ ì¼ì¹˜ í•˜ì§€ ì•Šì„ ê²½ìš°ì—ëŠ” ë‹¤ë¥¸ ê²°ê³¼ê°€ ë‚˜ì˜¬ ìˆ˜ ìˆë‹¤. 
ì¦‰, locì˜ ê²½ìš°ì—ëŠ” ì¸ë±ìŠ¤ ê°’ì„ ê¸°ì¤€ìœ¼ë¡œí•˜ê³ , ilocëŠ” ì €ì¥ëœ ìë£Œì˜ ìˆœì„œë¥¼ ê¸°ì¤€ìœ¼ë¡œ í•œë‹¤.
'''</span>
</code></pre></div></div>

<h2 id="selection--drop">Selection &amp; Drop</h2>

<h3 id="selection">Selection</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">).</span><span class="n">T</span>
<span class="c1"># ë°ì´í„°ì˜ í˜•í…Œë¥¼ í™•ì¸í•˜ê³ ì ì´ë ‡ê²Œ ë¶ˆëŸ¬ í™•ì¸ì„ ë§ì´ í•œë‹¤.
</span>
<span class="n">df</span><span class="p">[[</span><span class="s">'account'</span><span class="p">,</span> <span class="s">'street'</span><span class="p">,</span> <span class="s">'state'</span><span class="p">]].</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="c1"># í•´ë‹¹ columnê°’ë§Œ ë½‘ì•„ì¤„ ìˆ˜ ìˆë‹¤. 
</span>
<span class="n">df</span><span class="p">[</span><span class="s">'account'</span><span class="p">]</span>
<span class="c1"># Seriesí˜•íƒœë¡œ ë°˜í™˜
</span>
<span class="n">df</span><span class="p">[[</span><span class="s">'account'</span><span class="p">]]</span>
<span class="c1"># Dataframeí˜•íƒœë¡œ ë°˜í™˜
</span>
<span class="n">df_series</span><span class="p">[</span><span class="n">df_series</span><span class="o">&lt;</span><span class="mi">250000</span><span class="p">]</span>
<span class="c1"># boolean indexë„ ê°€ëŠ¥
</span>
<span class="n">account_series</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">]]</span>
<span class="c1"># fancy indexë¡œë„ selectê°€ëŠ¥í•˜ë‹¤.
</span>
<span class="c1">#===============================
# iloc, loc, basic
# basic
</span><span class="n">df</span><span class="p">[[</span><span class="s">'name'</span><span class="p">,</span><span class="s">'street'</span><span class="p">]][:</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># column, index
</span>
<span class="c1"># iloc
</span><span class="n">df</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">2</span><span class="p">,:</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># index, column
</span>
<span class="c1"># loc
</span><span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">211829</span><span class="p">,</span><span class="mi">320563</span><span class="p">],</span> <span class="p">[</span><span class="s">'name'</span><span class="p">,</span> <span class="s">'street'</span><span class="p">]]</span> <span class="c1"># index, column
</span>
<span class="c1"># ê°ê° ì…ë ¥ë˜ëŠ” ë°©ì‹ê³¼ ìˆœì„œë¥¼ ì˜ ê¸°ì–µí•  ê²ƒ
</span>
<span class="c1">#================================
# reset_index
</span>
<span class="n">df</span><span class="p">.</span><span class="n">reset_index</span><span class="p">()</span> 
<span class="c1"># ìƒˆë¡œìš´ ì¸ë±ìŠ¤ê°€ ìƒì„±ëœ dataframeì„ ë°˜í™˜í•¨
# drop=Trueë¥¼ ë³€ìˆ˜ë¡œ ë„£ìœ¼ë©´ ê¸°ì¡´ì˜ ì¸ë±ìŠ¤ë¥¼ ë“œëí•¨
</span></code></pre></div></div>

<h3 id="drop">drop</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="s">'city'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 
<span class="n">df</span><span class="p">.</span><span class="n">drop</span><span class="p">([</span><span class="s">'city'</span><span class="p">,</span> <span class="s">'state'</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># axisì¶•ë°©í–¥ìœ¼ë¡œ í•´ë‹¹ attributeë¥¼ drop
</span></code></pre></div></div>

<h2 id="dataframe-operation">DataFrame operation</h2>

<h3 id="add">add</h3>

<p><strong>Seires</strong></p>

<p><img src="/images/2021-01-28/22/2.png" alt="2.png" /></p>

<p><strong>DataFrame</strong></p>

<p><img src="/images/2021-01-28/22/3.png" alt="3.png" /></p>

<p><strong>Series+DataFrame</strong></p>

<p><img src="/images/2021-01-28/22/4.png" alt="4.png" /></p>

<h2 id="map-for-series">map for series</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">s1</span> <span class="o">=</span> <span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">s1</span><span class="p">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="s">'''
0    0
1    1
2    2
3    3
4    4
dtype: int64
'''</span>
<span class="n">s1</span><span class="p">.</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">).</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="s">'''
0     0
1     1
2     4
3     9
4    16
dtype: int64
'''</span>
<span class="n">z</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s">'A'</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="s">'B'</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span><span class="s">'C'</span><span class="p">}</span>
<span class="n">s1</span><span class="p">.</span><span class="nb">map</span><span class="p">(</span><span class="n">z</span><span class="p">).</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="s">'''
0    NaN
1      A
2      B
3      C
4    NaN
dtype: object
'''</span>
<span class="n">s2</span> <span class="o">=</span> <span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
<span class="n">s1</span><span class="p">.</span><span class="nb">map</span><span class="p">(</span><span class="n">s2</span><span class="p">).</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="s">'''
0    10
1    11
2    12
3    13
4    14
dtype: int64
'''</span>
</code></pre></div></div>

<p><img src="/images/2021-01-28/22/5.png" alt="5.png" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># replace
</span><span class="n">df</span><span class="p">.</span><span class="n">sex</span><span class="p">.</span><span class="n">replace</span><span class="p">({</span><span class="s">'male'</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s">'female'</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span> <span class="c1"># ìœ„ì™€ ê°™ì€ ê²°ê³¼ë¥¼ ë°˜í™˜
</span><span class="n">df</span><span class="p">.</span><span class="n">sex</span><span class="p">.</span><span class="n">replace</span><span class="p">([</span><span class="s">'male'</span><span class="p">,</span> <span class="s">'female'</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="c1"># ì´ë ‡ê²Œë„ ì„ ì–¸ ê°€ëŠ¥
</span></code></pre></div></div>

<h2 id="apply">apply</h2>

<p><img src="/images/2021-01-28/22/6.png" alt="6.png" /></p>

<p><img src="/images/2021-01-28/22/7.png" alt="7.png" /></p>

<p><img src="/images/2021-01-28/22/8.png" alt="8.png" /></p>

<h2 id="pands-built-in-functions">Pands built-in functions</h2>

<h3 id="describe">describe</h3>

<ul>
  <li>Numeric type ë°ì´í„°ì˜ ìš”ì•½ ì •ë³´ë¥¼ ë³´ì—¬ì¤Œ</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">describe</span><span class="p">()</span>
</code></pre></div></div>

<h3 id="unique">unique</h3>

<ul>
  <li>series dataì˜ ìœ ì¼í•œ ê°’ì˜ listë¥¼ ë°˜í™˜í•¨</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">race</span><span class="p">.</span><span class="n">unique</span><span class="p">()</span>
</code></pre></div></div>

<h3 id="sum">sum</h3>

<ul>
  <li>axis ê°’ì— ë”°ë¼ í•©ì˜ Seriesë¥¼ ë°˜í™˜í•¨</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> 
</code></pre></div></div>

<h3 id="isnull">isnull</h3>

<ul>
  <li>ê°’ì´ NaNì´ë©´ Trueì¸ DataFrameì„ ë°˜í™˜</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">isnull</span><span class="p">()</span>
</code></pre></div></div>

<h3 id="sort_values">sort_values</h3>

<ul>
  <li>í•´ë‹¹ ì»¬ëŸ¼ì˜ ê°’ì„ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬ëœ ìˆœì„œë¡œ DataFrameì„ ë°˜í™˜</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s">'age'</span><span class="p">,</span> <span class="s">'earn'</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="correlation--covariance">Correlation &amp; Covariance</h3>

<ul>
  <li>ê°’ì˜ ìƒê´€ê´€ê³„ë¥¼ ë³´ì—¬ì£¼ëŠ” í•¨ìˆ˜</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">age</span><span class="p">.</span><span class="n">corr</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">earn</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">age</span><span class="p">[(</span><span class="n">df</span><span class="p">.</span><span class="n">age</span> <span class="o">&lt;</span> <span class="mi">45</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">age</span> <span class="o">&gt;</span><span class="mi">25</span><span class="p">)].</span><span class="n">corr</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">earn</span><span class="p">)</span>
<span class="c1"># ì´ëŸ° ì‹ìœ¼ë¡œ ëˆì„ ë²„ëŠ” ë‚˜ì´ë¥¼ ì¡°ê±´ìœ¼ë¡œ ê±¸ ìˆ˜ ìˆë‹¤.
</span>
<span class="n">df</span><span class="p">.</span><span class="n">age</span><span class="p">.</span><span class="n">cov</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">earn</span><span class="p">)</span>
<span class="c1"># ê³µë¶„ì‚°, ë‚˜ì¤‘ì— ë°°ìš¸ê²ƒ
</span>
<span class="n">df</span><span class="p">.</span><span class="n">corrwith</span><span class="p">(</span><span class="n">df</span><span class="p">.</span><span class="n">earn</span><span class="p">)</span> 
<span class="c1"># df.earnê³¼ ë‹¤ë¥¸ ëª¨ë“  ê°’ì˜ ìƒê´€ê´€ê³„ë¥¼ ë³´ì—¬ì¤€ë‹¤.
</span>
<span class="n">df</span><span class="p">.</span><span class="n">sex</span><span class="p">.</span><span class="n">value_counts</span><span class="p">()</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> 
<span class="c1"># ê°’ì˜ ì „ì²´ ë¹„ìœ¨ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
</span></code></pre></div></div>

<h1 id="ë”¥ëŸ¬ë‹-í•™ìŠµë°©ë²•-ì´í•´í•˜ê¸°">ë”¥ëŸ¬ë‹ í•™ìŠµë°©ë²• ì´í•´í•˜ê¸°</h1>

<ul>
  <li>ì‹ ê²½ë§ ëª¨ë¸ì€ ê¸°ë³¸ì ìœ¼ë¡œ <strong>ë¹„ì„ í˜• ëª¨ë¸</strong>ì´ë‹¤.</li>
</ul>

<p><img src="/images/2021-01-28/22/9.png" alt="9.png" /></p>

<ul>
  <li>ì‹ ê²½ë§ ëª¨ë¸ì€ ê°€ì¤‘ì¹˜ í–‰ë ¬Wë¥¼ í†µí•´ ë°ì´í„°Xê°€ í–‰ë ¬Oë¡œ ì—°ê²°ë˜ê²Œ ëœë‹¤.</li>
</ul>

<p><img src="/images/2021-01-28/22/10.png" alt="10.png" /></p>

<ul>
  <li>ì†Œí”„íŠ¸ë§¥ìŠ¤ í•¨ìˆ˜ëŠ” ì£¼ì–´ì§„ ë°ì´í„°ê°€ íŠ¹ì • í´ë˜ìŠ¤ì— ì†í•  í™•ë¥ ì´ ì–¼ë§ˆë‚˜ ë ì§€ë¥¼ êµ¬í•˜ëŠ” í•¨ìˆ˜ì´ë‹¤.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="c1"># 1ë²ˆ ê³„ì‚°
</span><span class="n">vec</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">]])</span>
<span class="n">denumerator</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">exp</span><span class="p">(</span><span class="n">vec</span> <span class="o">-</span> <span class="n">np</span><span class="p">.</span><span class="nb">max</span><span class="p">(</span><span class="n">vec</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="n">numerator</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">denumerator</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">denumerator</span> <span class="o">/</span> <span class="n">numerator</span>
<span class="s">'''
array([[2.44728471e-01, 6.65240956e-01, 9.00305732e-02],
       [9.00305732e-02, 2.44728471e-01, 6.65240956e-01],
       [2.06106005e-09, 4.53978686e-05, 9.99954600e-01]])
'''</span>
<span class="c1"># 2ë²ˆ ê³„ì‚°
</span><span class="n">denumerator</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">exp</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span> 
<span class="n">numerator</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">denumerator</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">denumerator</span> <span class="o">/</span> <span class="n">numerator</span>
<span class="s">'''
array([[2.44728471e-01, 6.65240956e-01, 9.00305732e-02],
       [9.00305732e-02, 2.44728471e-01, 6.65240956e-01],
       [2.06106005e-09, 4.53978686e-05, 9.99954600e-01]])
'''</span>
<span class="s">'''
1ë²ˆ ê³„ì‚°ì€ ì§€ìˆ˜í•¨ìˆ˜ì˜ ì˜¤ë²„í”Œë¡œìš°ë¥¼ ë§‰ê¸° ìœ„í•´ ë²¡í„°ì˜ ìµœëŒ€ ìš”ì†Œ ê°’ì„ ê° ìš”ì†Œì—ì„œ ë¹¼ì£¼ê³  ê³„ì‚° í•œ ê²ƒì´ë‹¤. 2ë²ˆ ê³„ì‚°ì€ ê³µì‹ëŒ€ë¡œ ê³„ì‚°í•œ ê²ƒìœ¼ë¡œ ê²°ê³¼ê°€ ê°™ë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.
'''</span>
</code></pre></div></div>

<ul>
  <li>í•™ìŠµì„ í•  ë•ŒëŠ” softmax()í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ê³ , ì¶”ë¡ ì„ í•  ë•ŒëŠ” ê°€ì¥ í° ìš”ì†Œ ê°’ì˜ ìœ„ì¹˜ë¥¼ ë°˜í™˜í•˜ëŠ” one_hot vectorì„ ì‚¬ìš©í•œë‹¤.</li>
  <li>ì‹ ê²½ë§ì€ <strong>ì„ í˜•ëª¨ë¸ê³¼ í™œì„±í•¨ìˆ˜(activation function)ë¥¼ í•©ì„±í•œ í•¨ìˆ˜</strong>ì´ë‹¤.</li>
</ul>

<p><img src="/images/2021-01-28/22/11.png" alt="11.png" /></p>

<ul>
  <li>ì ì¬ë²¡í„°ë¥¼ ë³´í†µ ë‰´ëŸ°ì´ë¼ ë¶€ë¥´ë©°, ì´ê²ƒìœ¼ë¡œ ì´ë£¨ì–´ì§„ ë„¤íŠ¸ì›Œí¬ë¥¼ ì‹ ê²½ë§ì´ë¼ ë¶€ë¥¸ë‹¤.</li>
</ul>

<h2 id="í™œì„±í•¨ìˆ˜">í™œì„±í•¨ìˆ˜</h2>

<ul>
  <li>í™œì„±í•¨ìˆ˜(activation)ëŠ” <strong>ì°¨ì› $\mathbb R$ ìœ„ì— ì •ì˜ëœ ë¹„ì„ í˜• í•¨ìˆ˜</strong>ë¡œì„œ ë”¥ëŸ¬ë‹ì—ì„œ ë§¤ìš° ì¤‘ìš”í•œ ê°œë…ì´ë‹¤.</li>
  <li><strong>í™œì„±í•¨ìˆ˜ë¥¼ ì“°ì§€ ì•Šìœ¼ë©´ ë”¥ëŸ¬ë‹ì€ ì„ í˜•ëª¨í˜•ê³¼ ì°¨ì´ê°€ ì—†ë‹¤.</strong></li>
  <li>ì‹œê·¸ëª¨ì´ë“œ(sigmoid) í•¨ìˆ˜ë‚˜ tanh í•¨ìˆ˜ëŠ” ì „í†µì ìœ¼ë¡œ ë§ì´ ì“°ì´ë˜ í™œì„±í•¨ìˆ˜ì§€ë§Œ <strong>ë”¥ëŸ¬ë‹ì—ì„  ReLU í•¨ìˆ˜ë¥¼ ë§ì´ ì“°ê³ ìˆë‹¤.</strong></li>
</ul>

<p><img src="/images/2021-01-28/22/12.png" alt="12.png" /></p>

<ul>
  <li>ì‹ ê²½ë§ ë„¤íŠ¸ì›Œí¬ì—ì„œì˜ í™œì„±í•¨ìˆ˜ì™€ ì„ í˜•ëª¨ë¸ì˜ ê²°í•©ì„ ì‹ìœ¼ë¡œ í‘œí˜„í•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.</li>
</ul>

<p><img src="/images/2021-01-28/22/13.png" alt="13.png" /></p>

<ul>
  <li>ì´ëŸ° ëª¨ë¸ì„ ë‹¤ì¸µ í¼ì…‰íŠ¸ë¡ (Multi-layer Perceptron)ì´ë¼ê³  í•˜ë©°, ì„ í˜•ë³€í™˜ â†’ í™œì„±í•¨ìˆ˜ â†’ ì„ í˜•ë³€í™˜ ì´ëŸ° ì‹ìœ¼ë¡œ ì„ í˜• ë³€í™˜ì˜ ì‚¬ì´ì— í™œì„±í•¨ìˆ˜ê°€ ê¼­ ë“¤ì–´ê°€ì•¼ í•œë‹¤.</li>
</ul>

<p><img src="/images/2021-01-28/22/14.png" alt="14.png" /></p>

<ul>
  <li>ì‹ ê²½ë§ ëª¨ë¸ì„ ìˆ˜ì‹ìœ¼ë¡œ ë‚˜íƒ€ë‚´ë©´ ì´ì™€ ê°™ê³  Hí–‰ë ¬ì€ í™œì„±í•¨ìˆ˜ë¥¼ ì ìš©í•œ Zí–‰ë ¬ì´ë¼ê³  ë³´ë©´ ëœë‹¤.</li>
  <li>MLPì˜ íŒ¨ëŸ¬ë¯¸í„°ëŠ” Lê°œì˜ ê°€ì¤‘ì¹˜ í–‰ë ¬($W^{(1)}$, â€¦ , $W^{(L)}$)ê³¼ yì ˆí¸ì˜ í•´ë‹¹í•˜ëŠ” Lê°œì˜ B í–‰ë ¬ë¡œ ì´ë£¨ì–´ì ¸ìˆë‹¤.</li>
  <li>ì´ë ‡ê²Œ Lë²ˆì˜ ê³„ì‚°ì„ í†µí•´ ì¶œë ¥ì„ ë‚´ëŠ” ê²ƒì„ ìˆœì „íŒŒ(forward propagation)ë¼ ë¶€ë¥¸ë‹¤.</li>
</ul>

<h2 id="ì™œ-ì¸µì„-ì—¬ëŸ¬ê°œë¥¼-ìŒ“ì„ê¹Œ">ì™œ ì¸µì„ ì—¬ëŸ¬ê°œë¥¼ ìŒ“ì„ê¹Œ</h2>

<ul>
  <li>ì¸µì´ ê¹Šì„ìˆ˜ë¡ <strong>ëª©ì í•¨ìˆ˜ë¥¼ ê·¼ì‚¬í•˜ëŠ”ë° í•„ìš”í•œ ë‰´ëŸ°(ë…¸ë“œ)ì˜ ìˆ«ìê°€ í›¨ì”¬ ë¹¨ë¦¬ ì¤„ì–´ë“¤ì–´ ì¢€ ë” íš¨ìœ¨ì ìœ¼ë¡œ í•™ìŠµì´ ê°€ëŠ¥</strong>í•˜ë‹¤. ì¦‰ ì ì€ ë³€ìˆ˜ë¡œë„ ë³µì¡í•œ í•¨ìˆ˜ë¥¼ ê·¼ì‚¬í•  ìˆ˜ ìˆë‹¤.</li>
  <li>ë°˜ë©´, ì¸µì´ ì–‡ìœ¼ë©´ ë‰´ëŸ°ì˜ ìˆ«ìê°€ ê¸°í•˜ê¸‰ìˆ˜ì ìœ¼ë¡œ ëŠ˜ì–´ë‚˜ì„œ ë„“ì€ ì‹ ê²½ë§ì´ ë˜ì–´ì•¼ í•œë‹¤.</li>
  <li>ëŒ€ì‹  ì¸µì´ ê¹Šì–´ì§€ë©´ ìµœì í™”ì— ë” ë§ì€ ë…¸ë ¥ì„ ê¸°ìš¸ì—¬ì•¼ í•œë‹¤.</li>
</ul>

<h2 id="ë”¥ëŸ¬ë‹-í•™ìŠµì›ë¦¬-ì—­ì „íŒŒ-ì•Œê³ ë¦¬ì¦˜">ë”¥ëŸ¬ë‹ í•™ìŠµì›ë¦¬: ì—­ì „íŒŒ ì•Œê³ ë¦¬ì¦˜</h2>

<p><img src="/images/2021-01-28/22/15.png" alt="15.png" /></p>

<p><img src="/images/2021-01-28/22/16.png" alt="16.png" /></p>

<ul>
  <li>ì´ ê³¼ì •ì„ í†µí•´ ê° ì¸µì˜ ê°€ì¤‘ì¹˜ ë²¡í„°ë¥¼ í•™ìŠµì‹œí‚¤ê²Œ ëœë‹¤.</li>
</ul>

<h2 id="ì—°ì‡„ë²•ì¹™">ì—°ì‡„ë²•ì¹™</h2>

<p><img src="/images/2021-01-28/22/17.png" alt="17.png" /></p>

<ul>
  <li>ë”°ë¼ì„œ ì—­ì „íŒŒ ì•Œê³ ë¦¬ì¦˜ì˜ ê²½ìš°ì—ëŠ” ìˆœì „íŒŒì™€ ë‹¬ë¦¬ ë©”ëª¨ë¦¬ì˜ ì‚¬ìš©ëŸ‰ì´ ë§ì•„ ì§„ë‹¤.</li>
</ul>

<h2 id="2ì¸µ-mlp-ì—­ì „íŒŒ-ê³„ì‚°ê³¼ì •">2ì¸µ MLP ì—­ì „íŒŒ ê³„ì‚°ê³¼ì •</h2>

<p><img src="/images/2021-01-28/22/18.png" alt="18.png" /></p>

<p><img src="/images/2021-01-28/22/19.png" alt="19.png" /></p>
:ET